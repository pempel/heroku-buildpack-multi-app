#!/usr/bin/env bash

indent() {
    sed -u 's/^/      /'
}

BUILD_DIR=$1
CACHE_DIR=$2
ENV_DIR=$3
APP_DIR=$(cat ${ENV_DIR}/APP_DIR)

if [ ! -d "${APP_DIR}" ]; then
    echo "APP_DIR does not exist. Aborting" | indent
    exit 1
fi

find . -maxdepth 1 -type d -not -name ${APP_DIR} -not -name "." -exec rm -rf {} +
mv ${APP_DIR}/* .
rm -rf ${APP_DIR}

echo "Copied ${APP_DIR} successfully" | indent
